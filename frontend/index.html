<!DOCTYPE html>
<html>
<head>
  <title>Phishing Detection Demo</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div class="container">
    <h2>üîí Privacy-Preserving Phishing Detection</h2>

    <input type="text" id="urlInput" placeholder="Paste suspicious URL here" />

    <button onclick="checkUrl()">Analyze URL</button>

    <!-- Detection Flow Steps -->
    <div id="flowContainer" style="display: none;">
      <h3>üîÑ End-to-End Detection Process</h3>
      
      <div class="flow-step" id="step1">
        <div class="step-number">1</div>
        <div class="step-content">
          <div class="step-title">Canonicalize URL</div>
          <div class="step-description">Normalizing URL format...</div>
        </div>
      </div>

      <div class="flow-step" id="step2">
        <div class="step-number">2</div>
        <div class="step-content">
          <div class="step-title">Generate Fingerprint (HMAC-SHA512)</div>
          <div class="step-description">Creating cryptographic hash...</div>
          <div class="fingerprint-display" id="fingerprintDisplay" style="display: none;">
            <strong>Fingerprint Generated:</strong>
            <div class="fingerprint-box" id="fingerprintValue"></div>
          </div>
        </div>
      </div>

      <div class="flow-step" id="step2b">
        <div class="step-number">2b</div>
        <div class="step-content">
          <div class="step-title">Extract 12-char Prefix</div>
          <div class="step-description">Taking first 12 characters of fingerprint...</div>
          <div class="prefix-display" id="prefixDisplay" style="display: none;">
            <strong>Prefix:</strong>
            <div class="prefix-box" id="prefixValue"></div>
          </div>
        </div>
      </div>

      <div class="flow-step" id="step3">
        <div class="step-number">3</div>
        <div class="step-content">
          <div class="step-title">üóëÔ∏è Delete Original URL (Privacy)</div>
          <div class="step-description">Original URL removed from memory for privacy preservation...</div>
          <div class="delete-display" id="deleteDisplay" style="display: none;">
            <div class="delete-message">‚úì Original URL permanently deleted from memory</div>
            <div class="delete-note">Only fingerprint prefix used for further analysis</div>
          </div>
        </div>
      </div>

      <div class="flow-step" id="step4">
        <div class="step-number">4</div>
        <div class="step-content">
          <div class="step-title">Reputation Check</div>
          <div class="step-description">Comparing prefix against known phishing database...</div>
        </div>
      </div>

      <div class="flow-step" id="step5">
        <div class="step-number">5</div>
        <div class="step-content">
          <div class="step-title">Extract ML Features</div>
          <div class="step-description">Analyzing domain age, TLS, redirects, JavaScript...</div>
        </div>
      </div>

      <div class="flow-step" id="step6">
        <div class="step-number">6</div>
        <div class="step-content">
          <div class="step-title">ü§ñ Hybrid Analysis (ML + Advanced Checks)</div>
          <div class="step-description">Running Random Forest + WHOIS + SSL + Content Analysis...</div>
          
          <!-- ML Model Details -->
          <div class="ml-details" id="mlDetails" style="display: none;">
            <h4 style="margin-top: 15px; color: #2c3e50;">üìä Step-by-Step Analysis Breakdown</h4>
            
            <div style="margin-top: 12px; padding: 12px; background: #f8f9fa; border-radius: 5px;">
              <strong style="color: #2c3e50;">1Ô∏è‚É£ Machine Learning Model (60% weight)</strong>
              <div style="margin-left: 15px; margin-top: 8px; font-size: 12px;">
                <div>üå≥ Algorithm: Random Forest Classifier</div>
                <div>üéØ Decision Trees: 200 trees analyzing features</div>
                <div style="margin-top: 5px;">
                  <div>üìà Feature Analysis:</div>
                  <div style="margin-left: 10px; font-size: 11px; color: #555;">
                    <div>‚Ä¢ Domain Age: <span id="mlDomainAge">--</span> (68.25% importance)</div>
                    <div>‚Ä¢ HTTPS/TLS: <span id="mlTLS">--</span> (15.58% importance)</div>
                    <div>‚Ä¢ HTTP Redirects: <span id="mlRedirects">--</span> (13.37% importance)</div>
                    <div>‚Ä¢ Suspicious JS: <span id="mlJS">--</span> (2.80% importance)</div>
                  </div>
                </div>
                <div style="margin-top: 8px; padding: 8px; background: white; border-left: 3px solid #3498db;">
                  <strong>ML Prediction Score: <span id="mlScore" style="color: #3498db; font-size: 14px;">--</span></strong>
                </div>
              </div>
            </div>
            
            <div style="margin-top: 12px; padding: 12px; background: #f8f9fa; border-radius: 5px;">
              <strong style="color: #2c3e50;">2Ô∏è‚É£ Advanced Analysis (40% weight)</strong>
              <div style="margin-left: 15px; margin-top: 8px; font-size: 12px;">
                
                <div style="margin-bottom: 10px;">
                  <strong style="color: #27ae60;">üåç WHOIS Domain Registration Analysis</strong>
                  <div style="margin-left: 10px; font-size: 11px; color: #555; margin-top: 5px;">
                    <div>Domain Age: <span id="whoisAge">--</span></div>
                    <div>Registration Status: <span id="whoisStatus" style="color: #27ae60;">--</span></div>
                    <div style="margin-top: 5px; padding: 5px; background: white; border-left: 3px solid #27ae60;">
                      <strong>WHOIS Score: <span id="whoisScore" style="color: #27ae60;">--</span></strong>
                    </div>
                  </div>
                </div>
                
                <div style="margin-bottom: 10px;">
                  <strong style="color: #e74c3c;">üîí SSL Certificate Validation</strong>
                  <div style="margin-left: 10px; font-size: 11px; color: #555; margin-top: 5px;">
                    <div>Certificate: <span id="sslStatus">--</span></div>
                    <div>Domain Match: <span id="sslMatch">--</span></div>
                    <div>Expiry: <span id="sslExpiry">--</span></div>
                    <div style="margin-top: 5px; padding: 5px; background: white; border-left: 3px solid #e74c3c;">
                      <strong>SSL Score: <span id="sslScore" style="color: #e74c3c;">--</span></strong>
                    </div>
                  </div>
                </div>
                
                <div>
                  <strong style="color: #f39c12;">üìÑ Content & HTML Analysis</strong>
                  <div style="margin-left: 10px; font-size: 11px; color: #555; margin-top: 5px;">
                    <div>Login Forms: <span id="contentForms">--</span></div>
                    <div>Password Fields: <span id="contentPasswords">--</span></div>
                    <div>Phishing Keywords: <span id="contentKeywords">--</span></div>
                    <div>Suspicious Scripts: <span id="contentScripts">--</span></div>
                    <div style="margin-top: 5px; padding: 5px; background: white; border-left: 3px solid #f39c12;">
                      <strong>Content Score: <span id="contentScore" style="color: #f39c12;">--</span></strong>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div style="margin-top: 12px; padding: 12px; background: #ecf0f1; border-radius: 5px; border: 2px solid #34495e;">
              <strong style="color: #2c3e50; font-size: 13px;">‚öôÔ∏è Final Hybrid Score Calculation</strong>
              <div style="margin-left: 15px; margin-top: 10px; font-size: 12px; font-family: monospace; background: white; padding: 10px; border-radius: 3px;">
                <div>Final Score = (0.6 √ó ML) + (0.4 √ó Advanced)</div>
                <div style="margin-top: 8px; color: #555;">
                  <div>= (0.6 √ó <span id="hybridMlVal">--</span>) + (0.4 √ó <span id="hybridAdvVal">--</span>)</div>
                  <div style="margin-top: 5px; padding: 8px; background: #f0f0f0; border-radius: 3px;">
                    <strong style="font-size: 13px; color: #2c3e50;">= <span id="hybridFinal" style="color: #c0392b; font-size: 14px;">--</span></strong>
                  </div>
                </div>
              </div>
              <div style="margin-top: 10px; font-size: 11px; color: #555;">
                <div>‚úì Result > 0.5 = <span style="color: #e74c3c; font-weight: bold;">üö® PHISHING</span></div>
                <div>‚úì Result ‚â§ 0.5 = <span style="color: #27ae60; font-weight: bold;">‚úÖ LEGITIMATE</span></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="flow-step" id="step7">
        <div class="step-number">7</div>
        <div class="step-content">
          <div class="step-title">Final Result & Confidence</div>
          <div class="step-description" id="resultDescription">Determining threat level...</div>
        </div>
      </div>
    </div>

    <!-- Final Result -->
    <p id="status"></p>
    <p id="methodInfo" style="font-size: 12px; color: #666;"></p>
  </div>

  <script src="script.js"></script>
</body>
</html>
